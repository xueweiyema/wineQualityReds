Wine Quality Reds by xueweiyema
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# 加载你最终使用的所有组件
# 在这个代码块的分析中。

# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。

library(ggplot2)
library(gridExtra)
library(GGally)
library(dplyr)
getwd()
```

```{r echo=FALSE, Load_the_Data}
# 加载数据
wqr<-read.csv('wineQualityReds.csv')
```

# 单变量绘图选择
```{r echo=FALSE, Load_the_Data}
#out quality
summary(wqr$quality)
ggplot(aes(x = quality), data = wqr)+
  geom_histogram(binwidth = 1,bins = 1)+
  scale_x_continuous()+
  xlab("wine quality") + ylab("count") +
  ggtitle("Distribution of Wine Quality")

#input
summary(wqr$fixed.acidity)
p1<-ggplot(aes(x=fixed.acidity),data = wqr)+
  geom_histogram(bins=1,binwidth = 1)
summary(wqr$volatile.acidity)
p2<-ggplot(aes(x=volatile.acidity),data = wqr)+
  geom_histogram(bins =0.1,binwidth =0.1 )
summary(wqr$citric.acid)
p3<-ggplot(aes(x=citric.acid),data = wqr)+
  geom_histogram(bins = 0.01,binwidth = 0.05)
summary(wqr$residual.sugar)
p4<-ggplot(aes(x=residual.sugar),data = wqr)+
  geom_histogram(bins=1,binwidth = 1)
summary(wqr$chlorides)
p5<-ggplot(aes(x=chlorides),data = wqr)+
  geom_histogram(bins=0.01,binwidth = 0.02)
summary(wqr$free.sulfur.dioxide)
p6<-ggplot(aes(x=free.sulfur.dioxide),data = wqr)+
  geom_histogram(bins=5,binwidth = 5)
summary(wqr$total.sulfur.dioxide)
p7<-ggplot(aes(x=total.sulfur.dioxide),data = wqr)+
  geom_histogram(bins=30,binwidth = 30)
summary(wqr$density)
p8<-ggplot(aes(x=density),data = wqr)+
  geom_histogram(bins=0.001,binwidth =0.001 )
summary(wqr$pH)
p9<-ggplot(aes(x=pH),data = wqr)+
  geom_histogram(bins=0.1,binwidth = 0.1)
summary(wqr$sulphates)
p10<-ggplot(aes(x=sulphates),data = wqr)+
  geom_histogram(bins=0.2,binwidth = 0.2)
summary(wqr$alcohol)
p11<-ggplot(aes(x=alcohol),data = wqr)+
  geom_histogram(bins=0.1,binwidth = 0.2)

grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,ncol=4)
```


# 单变量分析
Notes:

```{r echo=FALSE, Load_the_Data}
?coord_trans
#把每个输入单量做sqrt和log10
p1<-ggplot(aes(x=fixed.acidity),data = wqr)+
  geom_histogram(bins=1,binwidth = 1)+
  coord_trans(x="sqrt")
p2<-ggplot(aes(x=volatile.acidity),data = wqr)+
  geom_histogram(bins =0.1,binwidth =0.1 )+
  coord_trans(x="sqrt")
p3<-ggplot(aes(x=citric.acid),data = wqr)+
  geom_histogram(bins = 0.01,binwidth = 0.05)+
  xlim(c(0,1))+
  coord_trans(x = "sqrt")
p4<-ggplot(aes(x=residual.sugar),data = wqr)+
  geom_histogram(bins=1,binwidth = 1)+
  coord_trans(x="sqrt")
p5<-ggplot(aes(x=chlorides),data = wqr)+
  geom_histogram(bins=0.01,binwidth = 0.02)+
  coord_trans(x="sqrt")
p6<-ggplot(aes(x=free.sulfur.dioxide),data = wqr)+
  geom_histogram(bins=5,binwidth = 5)+
  xlim(c(1.0,72.0))+
  coord_trans(x="sqrt")
p7<-ggplot(aes(x=total.sulfur.dioxide),data = wqr)+
  geom_histogram(bins=30,binwidth = 30)+
  xlim(c(6.0,289.0))+
  coord_trans(x="sqrt")
p8<-ggplot(aes(x=density),data = wqr)+
  geom_histogram(bins=0.001,binwidth =0.001 )+
  coord_trans(x="sqrt")
p9<-ggplot(aes(x=pH),data = wqr)+
  geom_histogram(bins=0.1,binwidth = 0.1)
p10<-ggplot(aes(x=sulphates),data = wqr)+
  geom_histogram(bins=0.2,binwidth = 0.2)+
  coord_trans(x="sqrt")
p11<-ggplot(aes(x=alcohol),data = wqr)+
  geom_histogram(bins=0.1,binwidth = 0.2)+
  coord_trans(x="sqrt")

grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,ncol=4)

```
```{r echo=FALSE, Load_the_Data}
p1<-ggplot(aes(x=fixed.acidity),data = wqr)+
  geom_histogram(bins=1,binwidth = 1)+
  coord_trans(x="log10")
p2<-ggplot(aes(x=volatile.acidity),data = wqr)+
  geom_histogram(bins =0.1,binwidth =0.1 )+
  coord_trans(x="log10")
p3<-ggplot(aes(x=citric.acid),data = wqr)+
  geom_histogram(bins = 0.1,binwidth = 0.1)+
  scale_x_log10()
p4<-ggplot(aes(x=residual.sugar),data = wqr)+
  geom_histogram(bins=1,binwidth = 1)+
  coord_trans(x="log10")
p5<-ggplot(aes(x=chlorides),data = wqr)+
  geom_histogram(bins=0.01,binwidth = 0.02)+
  coord_trans(x="log10")
p6<-ggplot(aes(x=free.sulfur.dioxide),data = wqr)+
  geom_histogram(bins=0.1,binwidth = 0.1)+
  scale_x_log10()
p7<-ggplot(aes(x=total.sulfur.dioxide),data = wqr)+
  geom_histogram(bins=0.1,binwidth = 0.1)+
  scale_x_log10()
p8<-ggplot(aes(x=density),data = wqr)+
  geom_histogram(bins=0.001,binwidth =0.001 )+
  coord_trans(x="log10")
p9<-ggplot(aes(x=pH),data = wqr)+
  geom_histogram(bins=0.1,binwidth = 0.1)+
  coord_trans(x="log10")
p10<-ggplot(aes(x=sulphates),data = wqr)+
  geom_histogram(bins=0.2,binwidth = 0.2)+
  coord_trans(x="log10")
p11<-ggplot(aes(x=alcohol),data = wqr)+
  geom_histogram(bins=0.1,binwidth = 0.2)+
  coord_trans(x="log10")

grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,ncol=4)



```




### 你的数据集结构是什么？
```{r echo=FALSE, Load_the_Data}
names(wqr)
str(wqr)
```

>我的数据集有十三个变量,其中,1个数序号,11个事输入的变量,1个变量quality是输出变量
>根据第一部分图可得符合正态分布的有Volatile acidity, Density, PH,其余的为偏态


### 你的数据集内感兴趣的主要特性有哪些？

>首先分析单输入变量和输出质量的相关性

```{r echo=FALSE, Load_the_Data}
?cor.test
with(wqr,cor.test(fixed.acidity,quality))
with(wqr,cor.test(volatile.acidity,quality))
with(wqr,cor.test(citric.acid,quality))
with(wqr,cor.test(residual.sugar,quality))
with(wqr,cor.test(chlorides,quality))
with(wqr,cor.test(free.sulfur.dioxide,quality))
with(wqr,cor.test(total.sulfur.dioxide,quality))
with(wqr,cor.test(density,quality))
with(wqr,cor.test(pH,quality))
with(wqr,cor.test(sulphates,quality))
with(wqr,cor.test(alcohol,quality))
```
>观察相关性选出相关性最大的几组数据
>alochol 0.476
>volatile.acidity -0.391
>sulphates 0.251
>citric.acid 0.226
>我感兴趣的特征有alochol,volatile.acidity,sulphates,citric.acid

### 你认为数据集内哪些其他特征可以帮助你探索兴趣特点？
>我还没有发现其他特征可以帮助我的探索

### 根据数据集内已有变量，你是否创建了任何新变量？
>并没有创建新的变量

### 在已经探究的特性中，是否存在任何异常分布？你是否对数据进行一些操作，如清洁、调整或改变数据的形式？如果是，你为什么会这样做？

>总体上来说每个变量表示的内容都是唯一的,而且描述相同类型的单位都是统一,并且并无发现异常值,的因此不太需要做清洗

# 双变量绘图选择
```{r echo=FALSE, Load_the_Data}

#fixed.acidity
p1=ggplot(aes(x=fixed.acidity,y=quality),data=wqr)+
  geom_point()+
  ggtitle('fixed.acidity and quality')
#volatile.acidity

p2<-ggplot(aes(x=volatile.acidity,y=quality),data=wqr)+
  geom_point()+
  ggtitle('volatile.acidity and quality')
#citric.acid  
summary(wqr$citric.acid)
p3<-ggplot(aes(x=citric.acid,y=quality),data=wqr)+
  geom_point()+
  ggtitle('citric.acid and quality')
#residual.sugar 
summary(wqr$residual.sugar)
p4=ggplot(aes(x=residual.sugar,y=quality),data=wqr)+
  geom_point()+
  ggtitle('residual.sugar and quality')
#chlorides
summary(wqr$chlorides)
p5<-ggplot(aes(x=chlorides,y=quality),data=wqr)+
  geom_point()+
  ggtitle('chlorides and quality')
#free.sulfur.dioxide
summary(wqr$free.sulfur.dioxide)
p6<-ggplot(aes(x=free.sulfur.dioxide,y=quality),data=wqr)+
  geom_point()+
  ggtitle('free.sulfur.dioxide and quality')
#total.sulfur.dioxide
summary(wqr$total.sulfur.dioxide)
p7=ggplot(aes(x=total.sulfur.dioxide,y=quality),data=wqr)+
  geom_point()+
  ggtitle('total.sulfur.dioxide and quality')
#density
summary(wqr$density)
p8<-ggplot(aes(x=density,y=quality),data=wqr)+
  geom_point()+
  ggtitle('density and quality')
#pH
summary(wqr$pH)
p9<-ggplot(aes(x=pH,y=quality),data=wqr)+
  geom_point()+
  ggtitle('pH and quality')
#sulphates
summary(wqr$sulphates)
p10=ggplot(aes(x=sulphates,y=quality),data=wqr)+
  geom_point()+
  ggtitle('sulphates and quality')
#alcohol
summary(wqr$alcohol)
p11<-ggplot(aes(x=alcohol,y=quality),data=wqr)+
  geom_point()+
  ggtitle('alcohol and quality')


grid.arrange(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,ncol=4)

```

# 双变量分析

### 探讨你在这部分探究中观察到的一些关系。这些感兴趣的特性与数据集内其他特性有什么区别？
```{r echo=FALSE, Load_the_Data}
ggpairs(wqr,columns=c(2:6,13))
ggpairs(wqr,columns=c(7:13))
ggpairs(wqr,columns=c(2:12))
?cor
cor(wqr)
```
>观察到的关联度比较高的有free.sulfur.dioxide和total.sulfur.dioxide,density和alochol,fixed.acidity和citric.acid，fixed.acidity和density,fixed.acidity和ph,volatile.acidity和citric.acid,citric.acid和ph.



### 你是否观察到主要特性与其他特性之间的有趣关系？
>与我感兴趣的特征有比较大的相关性的有,fixed.acidity和citric.acid,citric.acid和ph,volatile.acidity和citric.acid,density和alochol,

### 你发现最强的关系是什么？
>alochol 0.476 是我发现的最强关系



# 多变量绘图选择

```{r echo=FALSE, Multivariate_Plots}


```

# 多变量分析

###  探讨你在这部分探究中观察到的一些关系。通过观察感兴趣的特性，是否存在相互促进的特性？

### 这些特性之间是否存在有趣或惊人的联系呢？

### 选项：你是否创建过数据集的任何模型？讨论你模型的优缺点。

------

# 定稿图与总结

### 绘图一
```{r echo=FALSE, Plot_One}

```

### 描述一


### 绘图二
```{r echo=FALSE, Plot_Two}

```

### 描述二


### 绘图三
```{r echo=FALSE, Plot_Three}

```

### 描述三

------

# 反思